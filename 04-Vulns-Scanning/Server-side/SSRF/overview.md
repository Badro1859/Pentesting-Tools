# Server-side request forgery (SSRF)

> Server-side request forgery is a web security vulnerability that allows an attacker  
> to cause the server-side application to make requests to an unintended location.  

## Impact

A successful SSRF attack can often result in unauthorized actions or access to data within the organization. This can be in the vulnerable application, or on other back-end systems that the application can communicate with. In some situations, the SSRF vulnerability might allow an attacker to perform arbitrary command execution.  

An SSRF exploit that causes connections to external third-party systems might result in malicious onward attacks. these can appear to originate from the organization hosting the vulnerable application.  

## Common SSRF attacks

### SSRF attacks against the server

> In an SSRF attack against the server, the attacker causes the application  
> to make an HTTP request back to the server that is hosting the application,  
> via its loopback network interface.  

### SSRF attacks against other back-end systems

> In some cases, the application server is able to interact with back-end systems  
> that are not directly reachable by users. These systems often have non-routable  
> private IP addresses.

## Circumventing common SSRF defenses

### SSRF with blacklist-based input filters

- Use an alternative IP representation of `127.0.0.1`, such as `2130706433`, `017700000001`, or `127.1`.  
- Register your own domain name that resolves to `127.0.0.1`. You can use `spoofed.burpcollaborator.net` for this purpose.  
- Obfuscate blocked strings using URL encoding or case variation.  
- Provide a URL that you control, which redirects to the target URL.  

### SSRF with whitelist-based input filters

- You can embed credentials in a URL before the hostname, using the `@` character. For example: `<https://expected-host:fakepassword@evil-host>`
- You can use the `#` character to indicate a URL fragment. For example: `<https://evil-host#expected-host>`
- You can leverage the DNS naming hierarchy to place required input into a fully-qualified DNS name that you control. For example: `<https://expected-host.evil-host>`  

### Bypassing SSRF filters via open redirection

It is sometimes possible to bypass filter-based defenses by exploiting an open redirection vulnerability.  

> context: `/product/nextProduct?currentProductId=6&path=http://evil-user.net`  

## Blind SSRF vulnerabilities

> Blind SSRF vulnerabilities arise when an application can be induced  to issue a back-end HTTP request to a supplied URL,  
> but the response from the back-end request is not returned in the application's front-end response.  

### How to find and exploit blind SSRF vulnerabilities

> The most reliable way to detect blind SSRF vulnerabilities is using out-of-band (OAST) techniques.

## Finding hidden attack surface for SSRF vulnerabilities

### Partial URLs in requests

### URLs within data formats

### SSRF via the Referer header
